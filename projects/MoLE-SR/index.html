<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description" content="Mixture of LoRA Experts for Universal and Efficient Image Super-Resolution.">
    <meta name="keywords" content="Image super-resolution, Low-rank adaptation, Mixture of experts, Few-shot domain adaptation, Parameter-efficient fine-tuning.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MoLE-SR: Mixture of LoRA Experts for Universal and Efficient Image Super-Resolution</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <link rel="icon" href="./static/images/icon.svg">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css">
    <script src="https://cdn.knightlab.com/libs/juxtapose/latest/js/juxtapose.min.js"></script>

    <style>
        /* 只针对 Visual Results 那两张图 */
        .visual-results img {
            max-width: 1400px;
            width: 100%;
            height: auto;
        }
    
        /* ****************************************************** */
        /* 新增或修改的样式 */
        /* ****************************************************** */
    
        /* 交互模块的容器，比 is-max-desktop 更宽 */
        .interactive-container {
            max-width: 1000px; /* 自定义一个更大的宽度 */
            width: 90%;
            margin-left: auto;
            margin-right: auto;
        }
    
        /* 4个并列滑块的容器 */
        .sliders-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 列平均分配 */
            gap: 15px; /* 滑块之间的间距 */
            margin-top: 20px;
            width: 100%;
        }
    
        /* 单个滑块的容器 */
        .slider-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    
        .slider-item-label {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #4a4a4a;
        }
    
        /* 确保 Juxtapose 占据 100% 宽度 */
        .juxtapose {
            width: 100%;
            height: 100%;
        }
    
        /* 响应式适配 */
        @media (max-width: 1024px) {
            .sliders-grid {
                grid-template-columns: repeat(2, 1fr); /* 中等屏幕 2 列 */
                gap: 20px;
            }
        }
        @media (max-width: 768px) {
            .sliders-grid {
                grid-template-columns: 1fr; /* 小屏幕 1 列 */
                gap: 20px;
            }
            .interactive-container {
                width: 95%;
            }
        }
    
        /* 缩略图栏 */
        .thumb-bar {
            display: flex;
            justify-content: center;
            margin-top: 25px;
            gap: 10px;
            flex-wrap: wrap;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .thumb-bar img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border: 3px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s ease, border-color 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    
        .thumb-bar img.active {
            border-color: #3273dc;
            transform: scale(1.08);
            box-shadow: 0 6px 10px rgba(50, 115, 220, 0.3);
        }
    
        .thumb-bar img:hover {
            border-color: #999;
        }
    
        /* 移除原有的按钮样式 */
        .baseline-bar-top { display: none; } 
    </style>


</head>

<body>
<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">MoLE-SR: Mixture of LoRA Experts for Universal and Efficient Image Super-Resolution</h1>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">Yao Zhang<sup>1</sup>,</span>
                        <span class="author-block">Zhengxue Cheng<sup>1</sup>,</span>
                        <span class="author-block">Xinning Chai<sup>1</sup>,</span>
                        <span class="author-block">Li Song<sup>1</sup>,</span>
                    </div>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>1</sup>Shanghai Jiao Tong University</span>
                    </div>
                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <span class="link-block">
                                <a href="https://github.com/Yaozzz666/MoLE-SR" class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon"><i class="fab fa-github"></i></span>
                                    <span>Code</span>
                                </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Abstract</h2>
                <div class="content has-text-justified">
                    <p>
                    Most image super-resolution (SR) models trained on natural images achieve strong performance on standard benchmark datasets. However, their performance declines when applied to unseen data whose semantic content or degradation types differ substantially. A common remedy is class-driven adaptation, which fully fine-tunes the model for each manually defined class where a class is defined by either a semantic category or a degradation type. This approach, however, is typically training-expensive, data-hungry, and often causes catastrophic forgetting of previously learned domains.
                    To address these challenges, we propose MoLE-SR (Mixture of LoRA Experts for Super-Resolution), a representation-driven universal SR framework with high training and data efficiency. MoLE-SR enables few-shot adaptation to unseen domains while preserving performance on seen domains by adopting a decoupled two-stage learning strategy. Specifically, in the first stage, a shared SR backbone is combined with multiple lightweight LoRA experts, each trained separately on representative in-training domains to learn domain-specific representations, yielding notable performance gains with only a small fraction (1.5\%) of parameters updated. In the second stage, given only a few samples from an out-of-training domain, all experts remain fixed while an efficient layer-wise router is optimized to dynamically select and compose experts under the guidance of samples' representations, enabling effective adaptation with negligible (1.9\%) additional parameter overhead.
                    Extensive experiments across diverse SR architectures and out-of-training domains demonstrate that MoLE-SR achieves an average PSNR improvement of 0.79 dB on in-training domains and 0.93 dB on out-of-training domains under few-shot settings with minimal extra data and computation.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3 has-text-centered">Method</h2>
                <figure class="image is-3by2">
                    <img src="./static/images/overview1.png" alt="Overview of the method">
                </figure>

                <div class="content has-text-justified">
                    <p>
                        We propose MoLE-SR, a model-agnostic and representation-driven framework that enables rapid few-shot adaptation to unseen domains while preserving strong in-domain reconstruction. As shown in the figure, our framework consists of two aspects: representation-driven LoRA experts and representation-driven MoE router. Specifically, we train LoRA experts across multiple domains to capture each domain’s mean representation. In out-of-domain (OOD) scenarios, our representation-driven approach needs only a few samples from the unseen domain: we infer similarity between OOD samples' representation and in-domain centers in feature space, and combine experts according to inferred similarity to adapt to the target domain. We learn an efficient router from a few OOD samples to perform dynamic composition, thus realizing representation-guided adaptation. A layer-wise router is further designed to compose LoRA experts at fine granularity, enabling more flexible expert combination and yielding superior performance. By decoupling representation storage from selection and combination, MoLE-SR prevents catastrophic forgetting, enables expert reuse, and supports efficient OOD adaptation without updating the backbone or existing experts.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="section" style="padding-top: 0; padding-bottom: 0;">
    <div class="interactive-container">
        <h2 class="title is-3 has-text-centered">Interactive Super-Resolution Comparison</h2>

        <div id="sliders-grid-container" class="sliders-grid">
            </div>

        <div id="thumb-bar" class="thumb-bar"></div>
    </div>
</section>
<section class="section visual-results">
    <div class="container">
        <h2 class="title is-3 has-text-centered">Visual Results</h2>

        <div class="content">
            <h3 class="title is-4 has-text-centered">In-domain Datasets</h3>
            <figure class="image">
                <img src="./static/images/in_domain.png" alt="In-domain test set visualization">
            </figure>
        </div>

        <div class="content">
            <h3 class="title is-4 has-text-centered">Out-of-domain Datasets</h3>
            <figure class="image">
                <img src="./static/images/out_of_domain.png" alt="Out-of-domain test set visualization">
            </figure>
        </div>
    </div>
</section>
<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="column is-8">
                <div class="content">
                    <p>
                        This website is licensed under a <a rel="license"
                            href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                            Commons Attribution-ShareAlike 4.0 International License</a>.
                    </p>
                    <p>
                        Website adapted from the following <a href="https://github.com/nerfies/nerfies.github.io">source code</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

<script>
    let currentCase = 'case1';
    const caseList = ['case1', 'case2', 'case3', 'case4'];
    // 定义所有的基线模型
    const allBaselines = ['EDSR', 'RDN', 'ATD', 'PFT'];

    function initSliders(caseName) {
        const container = document.getElementById('sliders-grid-container');
        container.innerHTML = '';
    
        allBaselines.forEach(baseline => {
            const lqPath = `./static/images/${baseline}/before/${baseline}_${caseName}_before.png`;
            const hrPath = `./static/images/${baseline}/after/${baseline}_${caseName}_after.png`;
    
            const sliderItem = document.createElement('div');
            sliderItem.classList.add('slider-item');
    
            const label = document.createElement('div');
            label.classList.add('slider-item-label');
            label.textContent = baseline;
            sliderItem.appendChild(label);
    
            const newDiv = document.createElement('div');
            newDiv.className = 'juxtapose';
            newDiv.setAttribute('data-startingposition', '50%');
            newDiv.setAttribute('data-animate', 'true');
            newDiv.setAttribute('data-make-responsive', 'true');
            newDiv.innerHTML = `
                <img src="${lqPath}" data-label="Baseline">
                <img src="${hrPath}" data-label="Using MoLE-SR">
            `;
            sliderItem.appendChild(newDiv);
            container.appendChild(sliderItem);
        });
    
        // 注意这里用小写 juxtpose
        if (window.juxtapose) {
            juxtapose.scanPage();
        }
    }

    function renderThumbnails() {
        const container = document.getElementById('thumb-bar');
        container.innerHTML = '';

        // 使用第一个 baseline (EDSR) 的图片作为缩略图
        const baselineForThumbs = 'EDSR'; 

        caseList.forEach(caseName => {
            // 使用 'before' 图作为缩略图
            const img = document.createElement('img');
            img.src = `./static/images/${baselineForThumbs}/before/${baselineForThumbs}_${caseName}_before.png`;
            img.dataset.case = caseName;
            img.alt = `Thumbnail for ${caseName}`;

            if (caseName === currentCase) img.classList.add('active');

            img.addEventListener('click', () => {
                currentCase = caseName;
                document.querySelectorAll('#thumb-bar img').forEach(t => t.classList.remove('active'));
                img.classList.add('active');
                initSliders(currentCase); // 只需要传入 caseName
            });

            container.appendChild(img);
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        renderThumbnails();
        initSliders(currentCase);
    });
</script>

</body>
</html>
